# TransportCatalogue 

## Учебный проект по курсу С++ в Яндекс.Практикум (в разработке).

Реализация транспортного справочника. Строит карту маршрутов и получает данные по маршрутам и остановкам не её основе. Получение и сохранение данных в формате JSON с использованием собственной библиотеки. Визуализация карты маршрутов в формате SVG с использованием собственной библиотеки. Поиск кратчайшего пути по заданным условиям на основе построенной карты маршрутов с использованием алгоритмов на графах.

## Работа с классом транспортного справочника
По умолчанию создаётся пустой экземпляр класса TransportCatalogue.

Метод **AddStop** добавляет в каталог информацию об остановке - название и координаты.
Метод **SetDistanceBetweenStops** добавляет в каталог информацию о расстоянии по маршруту между двумя остановками.
Метод **AddRoute** формирует маршрут из списка остановок и добавляет его в каталог.
Метод **GetRouteInfo** возвращает информацию о маршруте.
Метод **GetStopInfo** возвращает список автобусов (маршрутов) проходящих через остановку.
Метод **GetDistanceBetweenStops** возвращает расстояние между остановками 1 и 2 - в прямом, либо если нет - в обратном направлении.

## Работа с данными в формате JSON

Класс JsonReader обеспечивает потоковое чтение данных в формате JSON, заполнение транспортного справочника полученными данными, формирование ответов на запросы в формате JSON и их потоковую запись.
В конструктор передается поток для чтения, с данными в формате JSON. Данные разбираются и сохраняются во внутреннем представлении класса.
Метод Dict GetRoutes_ возвращает ответ на запрос инфромации о маршруте. Метод ProcessRenderSettings загружает информацию о настройках отрисовки в экземпляр класса MapRenderer для последующей отрисовки маршрутов.
Метод AnswerRequests формирует ответы на запросы в формате JSON и выводит их поток записи

## Работа с визуализацией маршрутов
Класс MapRenderer обеспечивает отрисовку маршрутов в формате SVG.
Метод SetRenderSettings устанавливает настройки отрисовки
Метод GetSVG возвращает отрисованную карту маршрутов в формате SVG (далее её можно сохранить в svg файл для просмотра в любом внешнем svg-просмотрщике)

## Построение маршрутов по данным транспортного справочника (в разработке)

## Сборка и установка
1. Скачайте и соберите Google Protobuf под вашу версию компилятора
2. Создайте папку для сборки программы
3. Откройте консоль в данной папке и введите в консоли : cmake <путь к файлу CMakeLists.txt> -DCMAKE_PREFIX_PATH= <путь к собранной библиотеке Protobuf>
4. Чтобы отключить сборку тестов добавьте к предыдущей команде ключ : -DTESTING = OFF
5. Введите команду : cmake --build .
6. После сборки в папке сборки появится исполняемый файл transport_catalogue.exe.

## Использование собранной версии программы
Для работы программы в папке с программой надо предварительно создать файлы make_base.json и process_requests.json

Файл make_base.json должен представлять собой словарь JSON со следующими разделами (ключами) :
serialization_settings - настройки сериализации.
routing_settings - настройки маршрутизации.
render_settings - настройки отрисовки.
base_requests - массив данных об остановках и маршрутах.

Пример корректного файла make_base.json:
  ({
      "serialization_settings": {
          "file": "transport_catalogue.db"
      },
      "routing_settings": {
          "bus_wait_time": 2,
          "bus_velocity": 30
      },
      "render_settings": {
          "width": 1200,
          "height": 500,
          "padding": 50,
          "stop_radius": 5,
          "line_width": 14,
          "bus_label_font_size": 20,
          "bus_label_offset": [
              7,
              15
          ],
          "stop_label_font_size": 18,
          "stop_label_offset": [
              7,
              -3
          ],
          "underlayer_color": [
              255,
              255,
              255,
              0.85
          ],
          "underlayer_width": 3,
          "color_palette": [
              "green",
              [
                  255,
                  160,
                  0
              ],
              "red"
          ]
      },
      "base_requests": [
          {
              "type": "Bus",
              "name": "14",
              "stops": [
                  "Улица Лизы Чайкиной",
                  "Электросети",
                  "Ривьерский мост",
                  "Гостиница Сочи",
                  "Кубанская улица",
                  "По требованию",
                  "Улица Докучаева",
                  "Улица Лизы Чайкиной"
              ],
              "is_roundtrip": true
          },
          {
              "type": "Bus",
              "name": "24",
              "stops": [
                  "Улица Докучаева",
                  "Параллельная улица",
                  "Электросети",
                  "Санаторий Родина"
              ],
              "is_roundtrip": false
          },
          {
              "type": "Bus",
              "name": "114",
              "stops": [
                  "Морской вокзал",
                  "Ривьерский мост"
              ],
              "is_roundtrip": false
          },
          {
              "type": "Stop",
              "name": "Улица Лизы Чайкиной",
              "latitude": 43.590317,
              "longitude": 39.746833,
              "road_distances": {
                  "Электросети": 4300,
                  "Улица Докучаева": 2000
              }
          },
          {
              "type": "Stop",
              "name": "Морской вокзал",
              "latitude": 43.581969,
              "longitude": 39.719848,
              "road_distances": {
                  "Ривьерский мост": 850
              }
          },
          {
              "type": "Stop",
              "name": "Электросети",
              "latitude": 43.598701,
              "longitude": 39.730623,
              "road_distances": {
                  "Санаторий Родина": 4500,
                  "Параллельная улица": 1200,
                  "Ривьерский мост": 1900
              }
          },
          {
              "type": "Stop",
              "name": "Ривьерский мост",
              "latitude": 43.587795,
              "longitude": 39.716901,
              "road_distances": {
                  "Морской вокзал": 850,
                  "Гостиница Сочи": 1740
              }
          },
          {
              "type": "Stop",
              "name": "Гостиница Сочи",
              "latitude": 43.578079,
              "longitude": 39.728068,
              "road_distances": {
                  "Кубанская улица": 320
              }
          },
          {
              "type": "Stop",
              "name": "Кубанская улица",
              "latitude": 43.578509,
              "longitude": 39.730959,
              "road_distances": {
                  "По требованию": 370
              }
          },
          {
              "type": "Stop",
              "name": "По требованию",
              "latitude": 43.579285,
              "longitude": 39.733742,
              "road_distances": {
                  "Улица Докучаева": 600
              }
          },
          {
              "type": "Stop",
              "name": "Улица Докучаева",
              "latitude": 43.585586,
              "longitude": 39.733879,
              "road_distances": {
                  "Параллельная улица": 1100
              }
          },
          {
              "type": "Stop",
              "name": "Параллельная улица",
              "latitude": 43.590041,
              "longitude": 39.732886,
              "road_distances": {}
          },
          {
              "type": "Stop",
              "name": "Санаторий Родина",
              "latitude": 43.601202,
              "longitude": 39.715498,
              "road_distances": {}
          }
      ]
  })

Файл process_requests.json должен представлять собой словарь JSON со следующими разделами (ключами) :
serialization_settings - настройки сериализации.
stat_requests - массив запросов к каталогу

После этого можно приступать к работе с программой.

## Формирование транспортного каталога
Запустите собранную программу с ключом : ./transport_catalogue make_base
Программа прочитает файл make_base.json и сформирует на его основе транспортный каталог. В папке с программой появится файл transport_catalogue.db (или другой, в зависимости от того, какое название будет указано в "serialization_settings"). В данном файле будет сохранен каталог в двоичном виде.
В дальнейшем этот сохраненный каталог можно будет "разворачивать" для формирования ответов на запросы, без необходимости строить его заново.

## Системные требования
Компилятор С++ с поддержкой стандарта C++17 или новее
